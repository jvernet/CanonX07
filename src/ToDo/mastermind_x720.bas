5 DEFINT A-Z:DIM P(4),S(4),T(4)
6 DIM C(8),A(8):K=RND(0)
7 FOR I=1 TO 8:READ C(I),A(I):NEXT I
8 DATA &H0F,4,&H4F,4,&H8F,4,&HCF,4,&H0F,6,&H4F,6,&H8F,6,&HCF,6
9 T$=CHR$(28)+CHR$(29)+CHR$(30)+CHR$(31)+CHR$(22)+CHR$(18)+CHR$(13)
10 SCREEN2,2,2:CLS
20 LINE(0,0)-(255,0):LINE(0,0)-(0,191):LINE(255,0)-(255,191):LINE(0,191)-(255,191)
30 LOCATE 10,1:PRINT "Master Mind"
40 A=&H809D:FOR I=1 TO 8
50 POKE A,C(I):POKE A+&H1000,A(I)
60 A=A+32:NEXT I
65 FOR I=1 TO 4:S(I)=INT(RND(1)*8)+1:NEXT I
70 COL=1:N=1
75 P=1:LOCATE 3,15-N:PRINT N;
76 GOSUB 1010:FOR I=1 TO 4:P(I)=0:T(I)=S(I):NEXT I:K=0
80 ADR=&H807C+32*COL:POKE ADR,62:POKE ADR+&H1000,0
100 A$=INKEY$:IF A$="" THEN 100
110 Y=INSTR(T$,A$):IF Y=0 THEN 100
120 ON Y GOTO 200,300,400,500,600,700,800
200 P=P+1:IF P=5 THEN P=1
210 GOTO 310
300 P=P-1:IF P=0 THEN P=4
310 GOSUB 1000
320 GOTO 100
400 COL=COL-1:IF COL=0 THEN COL=8
410 GOTO 510
500 COL=COL+1:IF COL=9 THEN COL=1
510 POKE ADR,O:POKE ADR+&H1000,4
520 GOTO 80
600 IF P(P)=0 THEN 100
610 P(P)=0:K=K-1
620 POKE A2+32,0:GOTO 100
700 IF P(P)=0 THEN K=K+1
710 P(P)=COL
720 POKE A2+32,C(COL):POKE A2+&H1020,A(COL):GOTO 100
800 IF K<>4 THEN 100
805 POKE A2,0:POKE A2+&H1000,4:A2=&H81F1-32*N
810 K=0:FOR I=1 TO 4:IF P(I)<>T(I) THEN 840
820 K=K+1:P(I)=0:T(I)=-1
830 POKE A2,&HC2:POKE A2+&H1000,4:A2=A2+1
840 NEXT I:IF K=4 THEN 2000
850 FOR I=1 TO 4:FOR J=1 TO 4
860 IF P(I)<>T(J) THEN 890
870 P(I)=0:T(J)=-1
880 POKE A2,&H02:POKE A2+&H1000,6:A2=A2+1
890 NEXT J:NEXT I
900 N=N+1:IF N<10 THEN 75
910 A$="Perdu..."
920 LOCATE 3,5:PRINT "Sol";
930 A2=&H80A8:FOR I=1 TO 4
940 POKE A2,C(S(I)):POKE A2+&H1000,A(S(I)):A2=A2+2:NEXT I
950 GOTO 2010
1000 POKE A2,0:POKE A2+&H1000,4
1010 A2=&H81C6-N*32/P*2
1020 POKE A2,118:POKE A2+&H1000,0:RETURN
2000 A$="Gagne"
2010 LOCATE 1,3:PRINT A$
2020 LOCATE 1,4:PRINT "Voulez-vous rejouer? (O/N)";
2030 A$=INKEY$:IF A$="" THEN 2030
2040 IF A$="0" THEN RUN
2050 IF A$<>"N" THEN 2030
2060 CLS:PRINT"Au revoir...":END
