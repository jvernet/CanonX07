5 CONSOLE,,,0:CLEAR100
10 GOSUB4000:GOSUB5000
20 CLS:DEFINTX,Y:AR=10:M=1:X=RND(0)
30 N=0:C=2:K=0:FORI=0TO4:A(I)=0:NEXT
40 CL=0:P=0:Q=0:SX=0:S2=0:S=0:U$="#####"
100 LOCATE 5,0:PRINT"Crdit:";AR:BEEP20,2:BEEP20,2:BEEP20,2
110 LOCATE3,2:PRINT"Mise:";:PRINTUSINGU$;M;:PRINT" (";CHR$(141);CHR$(142);")"
115 S$=INKEY$:IFS$=""THEN115
120 IFASC(S$)=13THEN500
130 IFASC(S$)=30THENIFM<ARTHENM=M+1
140 IFASC(S$)=31THENIFM>1THENM=M-1
150 GOTO110
200 FORI=0TO4:PRINTMA$(I);" ";:NEXT
210 END
500 CLS:FORI=11TO83STEP18
510 GOSUB6000
520 NEXT
600 FORI=0TO4
610 IFA(I)=KTHENGOSUB7000ELSEX=A0(I):Y=A0(I+5)
620 NEXTI
700 FORI=0TO4:GOSUB8000
710 NEXTI
800 N=N+1:IFN=2THEN900
810 C0=C:LOCATE C,3:PRINTCHR$(140);
820 S$=INKEY$:IFS$=""THEN820
830 IFASC(S$)=13THENBEEP18,1:BEEP19,1:BEEP18,2:GOSUB890:K=1:GOTO600
840 IFASC(S$)=28THENIFC<14THENC=C+3:GOSUB890:GOTO810
850 IFASC(S$)=29THENIFC>2THENC=C-3:GOSUB890:GOTO810
860 IFS$=" "THENA((C-2)/3)=1:I=6*C-1:GOSUB6000:GOTO810
870 IFS$="E"THENFORI=0TO4:A(I)=0:NEXT:N=N-1:GOTO700
880 GOTO820
890 LOCATE C0,3:PRINTCHR$(132);:RETURN
900 FORI=1TO500:NEXT
902 '***************
903 '   RESULTATS
904 '***************
910 FORI=6TO9:IFA0(5)=A0(I)THENCL=CL+1
920 NEXT
930 IFC=4THEN980
940 FORI=0TO3:FORJ=I+1TO4
950 IFA0(J)=A0(I)THENP=P+1
960 NEXTJ,I
970 IFP<>0THEN1030
980 FORI=0TO4:S=S+A0(I):NEXT:S=S/5
990 FORI=0TO4:SX=SX+(A0(I)-S)^2:NEXT
1000 SX=SQR(SX/5):IFSX-SQR(2)<1E-8THENQ=4
1010 FORI=0TO4:S2=S2+A0(I)^2:NEXT
1020 IFS2=446THENQ=4
1030 CLS:IFP=0ANDQ<>4ANDCL<>4THENPRINT"Rien...":G=0:BEEP6000,15:GOTO1120
1040 IFP=1THENPRINT"Une paire.":G=1:GOSUB9100:GOTO1120
1050 IFP=2THENPRINT"Deux paires!":G=2:GOSUB9100:GOTO1120
1060 IFP=3THENPRINT"Brelan!!":G=3:GOSUB9100:GOTO1120
1070 IFP=4THENPRINT"Full!!!":G=10:GOSUB9300:GOTO1120
1080 IFP=6THENPRINT"Carr!!!!":G=40:GOSUB9300:GOTO1120
1090 IFQ<>4THENPRINT"Couleur!!!":G=7:GOSUB9200:GOTO1120
1100 IFCL<>4THENPRINT"Quinte!!":G=5:GOSUB9200:GOTO1120
1110 G=100:PRINT"QUINTE FLUSH";:IFS2=446THENPRINT" A L'AS!":G=500
1115 GOSUB9400
1120 G=G*M:LOCATE 5,1:PRINT"Gain:";G
1130 AR=AR+G-M:LOCATE 5,2:PRINT"Crdit:";AR
1140 IFAR<=0THEN3000
1150 IFINKEY$=""THEN1150
1160 IFM>ARTHENM=AR
1170 CLS:GOTO30
3000 '**************
3001 '     FIN
3002 '**************
3005 FORI=0TO400:NEXT
3007 BEEP7000,50
3010 CLS:PRINT"Il ne vous reste    plus que votre      chemise...  ADIEU
3020 END
4000 '**************
4001 '    TITRE
4002 '**************
4010 FONT$(250)="4,28,60,100,100,100,124,60"
4020 FONT$(251)="64,240,240,64,64,64,224,240"
4030 FONT$(252)="4,4,4,4,60,60,4,0"
4040 FONT$(253)="88,88,88,88,240,224,64,0"
4050 CLS:U=2:GOSUB4100:U=15:GOSUB4100
4060 LOCATE 7,1:PRINT"POKER"
4070 FORI=0TO16:LINE(40+I,15+I)-(72-I,15+I):BEEP(11+I),1:NEXT
4080 FORI=1TO1200:NEXT
4090 RETURN
4100 LOCATE U,1:PRINTCHR$(250);CHR$(251):LOCATE U,2:PRINTCHR$(252);CHR$(253)
4110 BEEP10,4:RETURN
4990 '**************
4991 'INITIALISATION
4992 '**************
5000 FONT$(128)="0,16,56,124,124,16,56,0"
5010 FONT$(129)="0,108,124,124,56,56,16,0"
5020 FONT$(130)="0,56,56,124,124,16,56,0"
5025 FONT$(132)="252,0,0,0,0,0,0,0"
5030 FONT$(131)="0,16,56,124,124,56,16,0"
5035 FONT$(140)="252,32,112,248,32,32,32,0"
5040 FONT$(145)="252,240,236,220,220,252,252,252"
5045 FONT$(141)="0,32,112,248,32,32,32,0"
5050 FONT$(146)="252,60,220,236,236,236,236,220"
5055 FONT$(142)="0,32,32,32,248,112,32,0"
5060 FONT$(147)="252,252,252,252,252,252,252,252"
5070 FONT$(148)="188,124,124,252,252,124,252,252"
5080 CA$="As 2 3 4 5 6 7 8 910 V D R"
5090 CO$=CHR$(128)+CHR$(129)+CHR$(130)+CHR$(131)
5100 RETURN
6000 '**************
6001 '    CARTES
6002 '  RETOURNEES
6003 '**************
6010 LOCATE(I+1)/6,1:PRINTCHR$(145);CHR$(146)
6020 LOCATE(I+1)/6,2:PRINTCHR$(147);CHR$(148)
6030 BEEPC,1:LINE(I,7)-(I+13,7):LINE-(I+13,24):LINE-(I,24):LINE-(I,7)
6040 LOCATE (I+1)/6,3:PRINTCHR$(132);
6050 RETURN
7000 '**************
7001 '    TIRAGES
7002 '  DES  CARTES
7003 '**************
7010 X=RND(1)*13:A0(I)=X
7020 Y=RND(1)*4+1:A0(I+5)=Y
7030 CA$(I)=MID$(CA$,2*X+1,2):CO$(I)=MID$(CO$,Y,1):MA$(I)=CA$(I)+CO$(I)
7040 FORJ=0TO4
7050 IFMA$(J)=MA$(I)ANDI<>JTHENJ=4:NEXTJ:GOTO7010
7060 NEXTJ
7070 RETURN
8000 '**************
8001 '   AFFICHAGE
8002 '  DES  CARTES
8003 '**************
8005 IFA(I)<>KTHENRETURN
8010 FORJ=1TO150:NEXT:CR=3*I+2:BEEPCR,2
8020 LOCATE CR,1:PRINTCA$(I)
8030 LOCATE CR,2:PRINTCO$(I);" "
8040 RETURN
9000 '**************
9010 '   MUSIQUE
9020 '**************
9100 FORI=1TO10:BEEP15,1:NEXT:RETURN
9200 FORI=10TO30:BEEPI,1:NEXT:RETURN
9300 FORI=13TO29STEP2:BEEPI,1:BEEPI-1,1:BEEPI+1,1:BEEPI,1:NEXT:RETURN
9400 RESTORE9450:DIMZ(36),Y(36):FORI=0TO36:READY(I),Z(I):BEEPY(I),Z(I):NEXT
9410 ERASEY,Z:RETURN
9450 DATA17,12,17,5,17,5,17,9,18,4,17,4,18,4,17,4,18,4,17,6,17,4,17,4,17,8,14,5
9460 DATA15,5,17,6,17,4,17,4,17,12,10,6,14,6,17,6,19,6,12,4,12,4,12,12,12,6
9470 DATA15,6,19,6,22,6,12,4,12,4,12,12,12,7,15,8,18,9,22,17