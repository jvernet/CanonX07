10 CLEAR200:DEFINTA-Z
20 SCREEN5,2,2:COLOR4,2,2:CLS
30 LOCATE 4,6:PRINT"-------"
40 LOCATE 4,7:PRINT"¨S.I.M¨"
50 LOCATE 4,8:PRINT"-------"
60 GOSUB1080
70 SCREEN5,2,2:C=3:F=2:PL=1:COLORC,F,PL
80 FORI=1TO750:NEXT:CLS
90 C=3:A$="Sommets : 4..8":GOSUB1070
100 GOSUB1080
110 N=VAL(R$):IFN<4ORN>8THEN100
120 DIMSE(N,N):GOSUB1090
130 A$="Niveau 1..3":GOSUB1070
140 GOSUB1080
150 NI=VAL(R$):IFNI<1ORNI>3THEN140
160 GOSUB1090
170 GOSUB850
180 DE=0
190 FORI=2TON
200 FORJ=1TOI-1
210 IFSE(I,J)=0ORSE(I,J)=1THEN250
220 NEXTJ,I
230 C=4:A$="Perdu!...":GOSUB1070:BEEP12,3
240 GOSUB1080:GOTO1110
250 K=0
260 K=K+1:IFK<3THEN290
270 C=3:A$="Jouable "+CHR$(J+48)+"-"+CHR$(I+48)
280 GOSUB1070:GOSUB1100:GOSUB1090
290 COLOR3:LOCATE 1,15:PRINT"De ";:GOSUB1080:A=VAL(R$)
300 LOCATE 4,15:CC$=CHR$(A+48)+" ‰ ":PRINTCC$;
310 IFA=0ANDDE=0THEN480
320 GOSUB1080:B=VAL(R$)
330 DD$=CHR$(B+48):PRINTDD$;
340 IFA<1ORA>NORB<1ORB>NORA=BTHEN260
350 A$="De "+CC$+DD$:GOSUB1090
360 ONSE(A,B)+3GOTO390,370,400,400,390,370
370 A$="TRIANGLE !..."
380 C=4:GOSUB1070:GOSUB1100:C=3:GOSUB1090:GOTO260
390 A$="Occup":GOTO380
400 SE(A,B)=2:SE(B,A)=2:C=3:GOSUB1060
410 FORI=1TON
420 ONSE(A,I)+3GOTO470,470,430,430,450,470
430 IFSE(B,I)<>2ORI=ATHEN470
440 SE(A,I)=4*SE(A,I)-1:SE(I,A)=SE(A,I):GOTO470
450 IFI=BORSE(B,I)<0THEN470
460 SE(B,I)=4*SE(B,I)-1:SE(I,B)=SE(B,I)
470 NEXTI
480 DE=1:MI=N:AA=0:C=INT((N-1)*RND(0))
490 FORI=2TON
500 B=I+C+2-(N-1)*INT((I+C)/(N-1))
510 D=INT((B-1)*RND(0))
520 FORJ=2TOB
530 A=J+D+1-(B-1)*INT((J+D)/(B-1))
540 IFNI<>3THEN660
550 IFSE(A,B)<>0THEN670
560 M=0
570 FORK=1TON
580 ONSE(A,K)+3GOTO610,590,590,620,620,620
590 IFSE(B,K)=-2THENM=M+1
600 GOTO620
610 IFSE(B,K)<1THENM=M+1
620 NEXTK
630 IFM=0THEN750
640 IFM>=MITHEN700
650 MI=M:A2=A:B2=B:GOTO700
660 IFSE(A,B)=0THEN750
670 IFSE(A,B)<>-1THEN700
680 IFNI=1THEN750
690 AA=A:BB=B
700 NEXTJ:NEXTI
710 IFMI<>NTHENA=A2:B=B2:GOTO750
720 IFAA<>0THENA=AA:B=BB:GOTO750
730 C=4:A$="Gagn !...":GOSUB1070:BEEP20,10
740 GOSUB1080:GOTO1110
750 A$="Je joue "+CHR$(48+A)+"-"+CHR$(B+48):C=4:GOSUB1070
760 GOSUB1060:GOSUB1090
770 SE(A,B)=-2:SE(B,A)=-2
780 FORI=1TON
790 ONSE(A,I)+3GOTO820,800,800,840,840,840
800 IFSE(B,I)<>-2ORI=ATHEN840
810 SE(A,I)=1-2*SE(A,I):SE(I,A)=SE(A,I):GOTO840
820 IFI=BORSE(B,I)>0THEN840
830 SE(B,I)=1-2*SE(B,I):SE(I,B)=SE(B,I)
840 NEXTI:GOTO190
850 COLORC:ONN-3GOTO860,870,880,890,900
860 RESTORE950:GOTO910
870 RESTORE970:GOTO910
880 RESTORE990:GOTO910
890 RESTORE1010:GOTO910
900 RESTORE1030
910 FORI=1TON:READX(I),Y(I):PSET(X(I),Y(I)),C:NEXT
920 FORI=1TON:READEX(I),EY(I):LOCATE EX(I),EY(I)
930 PRINTCHR$(I+48);:NEXT
940 RETURN
950 DATA75,21,175,21,175,125,75,125
960 DATA4,0,11,0,11,11,4,11
970 DATA136,18,216,54,184,138,88,138,56,54
980 DATA8,0,14,4,11,12,5,12,2,4
990 DATA88,18,184,18,232,84,184,150,88,150,40,84
1000 DATA5,0,11,0,15,7,11,13,5,13,1,7
1010 DATA136,18,200,54,216,114,168,150,104,150,56,114,72,54
1020 DATA8,0,13,4,14,9,10,13,6,13,2,9,3,4
1030 DATA104,18,168,18,216,54,216,114,168,150
1040 DATA104,150,56,114,56,54
1050 DATA6,0,10,0,14,4,14,9,10,13,6,13,2,9,2,4
1060 LINE(X(A),Y(A))-(X(B),Y(B)),C:RETURN
1070 LOCATE1,15:COLORC,F,PL:PRINTA$;:RETURN
1080 R$=INKEY$:IFR$=""THEN1080ELSERETURN
1090 LOCATE1,15:COLORF,F,PL:PRINTA$;:RETURN
1100 FORZ=1TO750:NEXTZ:RETURN
1110 C=2:GOSUB1090:A$="Encore (O/N)":C=4:GOSUB1070:GOSUB1080
1120 IFR$="N"THENEND ELSE ERASE SE:GOTO70